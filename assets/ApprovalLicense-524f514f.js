import{a as N,d as U,l as P}from"./topup-b7025679.js";import{u as w}from"./snackbar-93bdc399.js";import{a as E,b as L,d as y,j as x,V as A}from"./index-8e303578.js";import{a as q,b as R,V as $}from"./VDataTableServer-0715b14a.js";import{V}from"./VBtn-4acdbe86.js";import{d as S,o as _,h as g,g as e,f as a,j as l,r as c,R as j,S as b,i as B,m as Y,a as C,a7 as F}from"./index-3573355a.js";import{V as M}from"./VForm-9b4298fa.js";import{V as O}from"./VTextarea-4f85dd16.js";import{_ as Q}from"./FilterHeaderCheckbox.vue_vue_type_script_setup_true_lang-1228bb4a.js";import{b as D,a as T,V as H}from"./VRow-3e89ef20.js";import{V as h}from"./VChip-5b2c32d2.js";import"./api-61c700d5.js";import"./tag-49144cbd.js";import"./VList-c72b8c8a.js";import"./lazy-bd4f37e9.js";import"./filter-5d2ebabd.js";import"./VTextField-e0e32189.js";const z=S({__name:"ApproveLicense",props:{licenseId:{}},emits:["approved"],setup(k,{emit:p}){const r=k,i=p,o=w();function f(u){N(r.licenseId).then(()=>{i("approved"),o.showSnackbar("Approve license success","success"),setTimeout(()=>{u.value=!1},1e3)}).catch(()=>{o.showSnackbar("Approve license failed","error")})}return(u,v)=>(_(),g(R,{width:"auto",activator:"parent"},{default:e(({isActive:m})=>[a(A,null,{default:e(()=>[a(E,null,{default:e(()=>[a(L,null,{default:e(()=>[l(" Approve ")]),_:1})]),_:1}),a(y,null,{default:e(()=>[l(" Are you sure to approve this license? ")]),_:1}),a(x,null,{default:e(()=>[a(q),a(V,{onClick:n=>m.value=!1,color:"primary"},{default:e(()=>[l(" CANCEL ")]),_:2},1032,["onClick"]),a(V,{onClick:n=>f(m),class:"bg-primary"},{default:e(()=>[l(" APPROVE ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1}))}}),G=S({__name:"DeclineLicense",props:{licenseId:{}},emits:["declined"],setup(k,{emit:p}){const r=c(),i=c(""),o=k,f=p,u=w();async function v(m){const{valid:n}=await r.value.validate();n&&U(o.licenseId,i.value).then(()=>{f("declined"),u.showSnackbar("Decline license success","success"),setTimeout(()=>{m.value=!1},1e3)}).catch(()=>{u.showSnackbar("Decline license success","error")})}return(m,n)=>(_(),g(R,{width:"auto",activator:"parent"},{default:e(({isActive:d})=>[a(A,null,{default:e(()=>[a(E,null,{default:e(()=>[a(L,null,{default:e(()=>[l(" Decline ")]),_:1})]),_:1}),a(y,null,{default:e(()=>[l(" Are you sure to decline this license? ")]),_:1}),a(y,null,{default:e(()=>[a(M,{ref_key:"myForm",ref:r},{default:e(()=>[a(O,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=s=>i.value=s),rules:[s=>!!s],label:"Notes"},null,8,["modelValue","rules"])]),_:1},512)]),_:1}),a(x,null,{default:e(()=>[a(q),a(V,{onClick:s=>d.value=!1,color:"primary"},{default:e(()=>[l(" CANCEL ")]),_:2},1032,["onClick"]),a(V,{onClick:s=>v(d),class:"bg-primary"},{default:e(()=>[l(" DECLINE ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1}))}}),J=C("div",{class:"text-h5 font-weight-bold"},"Approval License",-1),K={class:"d-flex justify-center"},W={class:"d-flex justify-center align-center"},ve=S({__name:"ApprovalLicense",setup(k){const p=c(1),r=c(10),i=c(100),o=c(!0),f=c([]),u=[{label:"Approved",value:"approved"},{label:"Declined",value:"declined"},{label:"Pending",value:"pending"}],v=c(u.map(d=>d.value)),m=[{title:"REQUESTER",key:"requester"},{title:"ISSUER",key:"issuer"},{title:"QUOTA",key:"quota"},{title:"REQUEST DATE",key:"createdAt"},{title:"STATUS",key:"state",sortable:!1,align:"center"},{title:"ACTION",key:"action",sortable:!1,align:"center"}];function n(){o.value=!0,P({limit:r.value,page:p.value,states:v.value}).then(async d=>{const s=d.data.result.topupRequests;s!=null&&(f.value=s),i.value=d.data.result.recordsCount}).finally(()=>{setTimeout(()=>{o.value=!1},2e3)})}return j(()=>{n()}),(d,s)=>(_(),g(H,{fluid:""},{default:e(()=>[a(T,null,{default:e(()=>[a(D,null,{default:e(()=>[J]),_:1})]),_:1}),a(T,null,{default:e(()=>[a(D,null,{default:e(()=>[a(A,null,{default:e(()=>[a(y,null,{default:e(()=>[a($,{"return-object":"","show-select":"",color:"secondary",page:p.value,"onUpdate:page":s[1]||(s[1]=t=>p.value=t),"items-per-page":r.value,"onUpdate:itemsPerPage":s[2]||(s[2]=t=>r.value=t),headers:m,"items-length":i.value,items:f.value,loading:o.value,"item-value":"name"},{loading:e(()=>[l(" Loading approval licenses... ")]),"item.quota":e(({item:t})=>[l(b(t.quota.toLocaleString("id")),1)]),"item.state":e(({item:t})=>[t.state=="approved"?(_(),g(h,{key:0,label:"",color:"success"},{default:e(()=>[l(" Approved ")]),_:1})):t.state=="pending"?(_(),g(h,{key:1,label:"",color:"warning"},{default:e(()=>[l(" Pending ")]),_:1})):t.state=="declined"?(_(),g(h,{key:2,label:"",color:"error"},{default:e(()=>[l(" Declined ")]),_:1})):B("",!0)]),"item.createdAt":e(({item:t})=>[l(b(Y(F)(t.createdAt,"DD MMM YYYY HH:mm")),1)]),"item.action":e(({item:t})=>[C("div",K,[a(V,{disabled:t.state!="pending",color:"success",class:"me-2"},{default:e(()=>[l(" Approve "),a(z,{onApproved:n,"license-id":t.id},null,8,["license-id"])]),_:2},1032,["disabled"]),a(V,{disabled:t.state!="pending",color:"error"},{default:e(()=>[l(" Decline "),a(G,{onDeclined:n,"license-id":t.id},null,8,["license-id"])]),_:2},1032,["disabled"])])]),"item.issuer":e(({item:t})=>[l(b(t.issuer.name),1)]),"item.requester":e(({item:t})=>[l(b(t.requester.name),1)]),"header.state":e(({column:t})=>[C("span",W,[C("div",null,b(t.title),1),a(Q,{disabled:o.value,items:u,modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=I=>v.value=I)},null,8,["disabled","modelValue"])])]),_:2},1032,["page","items-per-page","items-length","items","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{ve as default};
