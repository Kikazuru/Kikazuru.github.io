import{_ as H,a as J}from"./ReactivateUser.vue_vue_type_script_setup_true_lang-dc032174.js";import{d as P,r as _,o as f,h as p,g as e,f as a,j as o,m as u,a as b,ae as j,w as K,l as B,ad as D,i as T,S,af as Q}from"./index-69d1502a.js";import{a as W,u as Y,g as Z}from"./user-2f0087e0.js";import{e as M,n as O}from"./rules-3c02e6d9.js";import{a as h,b as q,V as ee}from"./VDataTableServer-921b4e3b.js";import{b as x,a as w,V as ae}from"./VRow-1f387fa0.js";import{V as X}from"./VForm-acfbacb3.js";import{V as F,a as L,b as I,d as A,j as z}from"./index-6405a72a.js";import{V as E}from"./VTextField-f7af6f26.js";import{V,p as R}from"./VBtn-421a5577.js";import{u as te}from"./snackbar-867af268.js";import{q as le,s as se,t as re}from"./lazy-eda09f13.js";import{_ as oe}from"./FilterHeaderCheckbox.vue_vue_type_script_setup_true_lang-e8950ebf.js";import{V as N}from"./VChip-b541bb3f.js";import"./VList-0497e142.js";import"./tag-446592ee.js";import"./filter-bfc06a5f.js";const ue=b("div",{class:"mb-3"},"Login Credentials",-1),ne=b("div",{class:"mb-3"},"Personal Info",-1),de=P({__name:"AddUser",emits:["userAdded"],setup($,{emit:k}){const s=_(),i=_({name:"",email:""}),v=k;async function t(n){const{valid:c}=await s.value.validate();if(c){const m=j(i.value);W(m).then(l=>{l.data.success&&(v("userAdded"),n.value=!1,s.value.reset())})}}return(n,c)=>(f(),p(q,{activator:"parent"},{default:e(({isActive:m})=>[a(w,null,{default:e(()=>[a(h),a(x,{cols:"12",xxl:"4",xl:"4",lg:"4",md:"4",sm:"7"},{default:e(()=>[a(X,{ref_key:"myForm",ref:s},{default:e(()=>[a(F,{"max-height":"90vh",class:"overflow-auto"},{default:e(()=>[a(L,null,{default:e(()=>[a(I,null,{default:e(()=>[o(" Add User ")]),_:1})]),_:1}),a(A,null,{default:e(()=>[ue,a(E,{rules:u(M),modelValue:i.value.email,"onUpdate:modelValue":c[0]||(c[0]=l=>i.value.email=l),type:"email",label:"Email"},null,8,["rules","modelValue"])]),_:1}),a(A,{class:"pt-0"},{default:e(()=>[ne,a(E,{class:"mb-3",rules:u(O),modelValue:i.value.name,"onUpdate:modelValue":c[1]||(c[1]=l=>i.value.name=l),label:"Name"},null,8,["rules","modelValue"])]),_:1}),a(z,null,{default:e(()=>[a(h),a(V,{onClick:l=>t(m),class:"bg-primary"},{default:e(()=>[o(" ADD ")]),_:2},1032,["onClick"]),a(V,{onClick:l=>m.value=!1,variant:"text",color:"primary"},{default:e(()=>[o(" CANCEL ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1536)]),_:2},1024),a(h)]),_:2},1024)]),_:1}))}}),ie=b("div",{class:"mb-3"},"Credentials",-1),me=b("div",{class:"mb-3"},"Personal Info",-1),ce=P({__name:"UpdateUser",props:{user:{}},emits:["update:user","update:show","userUpdated"],setup($,{emit:k}){const s=_(),i=k,v=$,t=_({email:v.user.email,name:v.user.name,role:v.user.role}),n=te();async function c(m){const{valid:l}=await s.value.validate();if(l){const y=j(t.value);Y(v.user.id,y).then(d=>{if(!d.data.success)throw Error;i("userUpdated",y),s.value.reset(),n.showSnackbar("User data has been updated!","success")}).catch(()=>{n.showSnackbar("Update user failed!","error")}).finally(()=>{m.value=!1})}}return(m,l)=>(f(),p(q,{activator:"parent"},{default:e(({isActive:y})=>[a(w,null,{default:e(()=>[a(h),a(x,{cols:"12",xxl:"4",xl:"4",lg:"4",md:"4",sm:"7"},{default:e(()=>[a(X,{ref_key:"myForm",ref:s},{default:e(()=>[a(F,{"max-height":"90vh",class:"overflow-auto"},{default:e(()=>[a(L,null,{default:e(()=>[a(I,null,{default:e(()=>[o(" Update User ")]),_:1})]),_:1}),a(A,null,{default:e(()=>[ie,a(E,{class:"mb-3",rules:u(M),modelValue:t.value.email,"onUpdate:modelValue":l[0]||(l[0]=d=>t.value.email=d),type:"email",label:"Email"},null,8,["rules","modelValue"])]),_:1}),a(A,{class:"pt-0"},{default:e(()=>[me,a(E,{class:"mb-3",rules:u(O),modelValue:t.value.name,"onUpdate:modelValue":l[1]||(l[1]=d=>t.value.name=d),label:"Name"},null,8,["rules","modelValue"])]),_:1}),a(z,null,{default:e(()=>[a(h),a(V,{onClick:d=>c(y),class:"bg-primary"},{default:e(()=>[o(" UPDATE ")]),_:2},1032,["onClick"]),a(V,{onClick:d=>y.value=!1,variant:"text",color:"primary"},{default:e(()=>[o(" CANCEL ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1536)]),_:2},1024),a(h)]),_:2},1024)]),_:1}))}}),fe={class:"d-flex justify-center flex-wrap"},pe={class:"d-flex justify-center align-center"},ve=P({__name:"ViewUser",props:{loadApi:{type:Function}},setup($){const k=$,s=_(1),i=_(10),v=_(100),t=_(!0),n=_([]),c=[{label:"Active",value:"active"},{label:"Deleted",value:"deleted"},{label:"Pending",value:"pending"}],m=_(c.map(g=>g.value));K(m,()=>{U()});const l=[{title:"NAME",key:"name"},{title:"EMAIL",key:"email"},{title:"STATUS",key:"state",sortable:!1,align:"center"}],d=B().permissions;(d["user.update"]||d["user.reactivate"])&&l.push({title:"UPDATE",key:"update",sortable:!1,align:"center"}),d["user.delete"]&&l.push({title:"DELETE",key:"delete",sortable:!1,align:"center"});function U(){t.value=!0,k.loadApi({limit:i.value,page:s.value,states:m.value}).then(g=>{n.value=g.data.result.users||[],v.value=g.data.result.recordsCount}).finally(()=>{setTimeout(()=>{t.value=!1},2e3)})}return(g,C)=>(f(),p(F,null,{default:e(()=>[a(L,null,{default:e(()=>[a(I,null,{default:e(()=>[o(" List Of Users ")]),_:1})]),_:1}),a(A,{class:"mt-2"},{default:e(()=>[a(w,null,{default:e(()=>[a(x,null,{default:e(()=>[a(V,{variant:"outlined","prepend-icon":u(le)},{default:e(()=>[o(" EXPORT ")]),_:1},8,["prepend-icon"])]),_:1}),a(h),a(x,{cols:"12",xxl:"4",xl:"4",lg:"4",md:"4"},{default:e(()=>[b("div",fe,[a(E,{placeholder:"Search user or group name","hide-details":"",variant:"outlined",density:"compact"}),u(d)["user.create"]?(f(),p(V,{key:0,variant:"tonal",class:"bg-primary ms-2"},{default:e(()=>[D(g.$slots,"add",{loadUsers:U}),o(" ADD USER ")]),_:3})):T("",!0)])]),_:3})]),_:3})]),_:3}),a(A,null,{default:e(()=>[a(ee,{"return-object":"","show-select":"",color:"secondary","items-per-page":i.value,"onUpdate:itemsPerPage":C[1]||(C[1]=r=>i.value=r),page:s.value,"onUpdate:page":C[2]||(C[2]=r=>s.value=r),headers:l,"items-length":v.value,items:n.value,loading:t.value,"item-value":"name","onUpdate:options":U},{loading:e(()=>[o(" Loading users... ")]),"item.group-name":e(()=>[o(S("-"))]),"item.state":e(({item:r})=>[r.state=="active"?(f(),p(N,{key:0,color:"success",label:""},{default:e(()=>[o("Active")]),_:1})):r.state=="pending"?(f(),p(N,{key:1,color:"warning",label:""},{default:e(()=>[o("Pending")]),_:1})):r.state=="deleted"?(f(),p(N,{key:2,color:"error",label:""},{default:e(()=>[o("Deleted")]),_:1})):T("",!0)]),"item.update":e(({item:r})=>[r.state=="deleted"&&u(d)["user.reactivate"]?(f(),p(V,{key:0,variant:"tonal",color:"blue"},{default:e(()=>[o(" Reactivate "),D(g.$slots,"reactivate",{user:r,loadUsers:U})]),_:2},1024)):u(d)["user.update"]?(f(),p(V,{key:1,disabled:r.state=="deleted",color:"secondary",variant:"text",icon:""},{default:e(()=>[a(R,null,{default:e(()=>[o(S(u(se)),1)]),_:1}),D(g.$slots,"update",{user:r,loadUsers:U})]),_:2},1032,["disabled"])):T("",!0)]),"item.delete":e(({item:r})=>[a(V,{disabled:r.state=="deleted",color:"secondary",variant:"text",icon:""},{default:e(()=>[a(R,null,{default:e(()=>[o(S(u(re)),1)]),_:1}),D(g.$slots,"delete",{user:r,loadUsers:U})]),_:2},1032,["disabled"])]),"header.state":e(({column:r})=>[b("span",pe,[b("div",null,S(r.title),1),a(oe,{disabled:t.value,items:c,modelValue:m.value,"onUpdate:modelValue":C[0]||(C[0]=G=>m.value=G)},null,8,["disabled","modelValue"])])]),_:2},1032,["items-per-page","page","items-length","items","loading"])]),_:3})]),_:3}))}}),_e=b("div",{class:"text-h5 font-weight-bold"},"User Management",-1),Ne=P({__name:"UserManagement",setup($){const s=B().permissions;return(i,v)=>(f(),p(ae,{fluid:""},{default:e(()=>[a(w,null,{default:e(()=>[a(x,null,{default:e(()=>[_e]),_:1})]),_:1}),a(w,null,{default:e(()=>[a(x,null,{default:e(()=>[u(s)["user.see"]?(f(),p(ve,{key:0,"load-api":u(Z)},Q({_:2},[u(s)["user.create"]?{name:"add",fn:e(({loadUsers:t})=>[a(de,{onUserAdded:t},null,8,["onUserAdded"])]),key:"0"}:void 0,u(s)["user.update"]?{name:"update",fn:e(({loadUsers:t,user:n})=>[a(ce,{onUserUpdated:t,user:n},null,8,["onUserUpdated","user"])]),key:"1"}:void 0,u(s)["user.delete"]?{name:"delete",fn:e(({loadUsers:t,user:n})=>[a(H,{onUserDeleted:t,user:n},null,8,["onUserDeleted","user"])]),key:"2"}:void 0,u(s)["user.reactivate"]?{name:"reactivate",fn:e(({loadUsers:t,user:n})=>[a(J,{onReactivated:t,user:n},null,8,["onReactivated","user"])]),key:"3"}:void 0]),1032,["load-api"])):T("",!0)]),_:1})]),_:1})]),_:1}))}});export{Ne as default};
