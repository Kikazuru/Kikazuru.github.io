import{m as oe,a as ue,u as ie,b as M,f as re,c as ce,d as de}from"./VTextField-f7af6f26.js";import{h as fe,a as me,d as pe,V as ve}from"./index-6405a72a.js";import{q as ge,a9 as ye,x as Ve,C as he,y as ke,z as g,r as f,w as Ce,J as Se,aa as be,f as l,D as x,Y as N,ab as O,Z as _e,ac as Ie,d as Re,l as Pe,R as we,o as _,h as z,g as n,a as T,m as Q,j as d,ad as Fe,i as J,c as Ae,S as I}from"./index-69d1502a.js";import{V as B}from"./VChip-b541bb3f.js";import{r as ze}from"./lazy-eda09f13.js";import{_ as Be}from"./MessageDialog.vue_vue_type_script_setup_true_lang-db1065c2.js";import{_ as qe}from"./FilterHeaderCheckbox.vue_vue_type_script_setup_true_lang-e8950ebf.js";import{V as Y,p as De}from"./VBtn-421a5577.js";import{V as xe}from"./VDataTableServer-921b4e3b.js";const Ne=ge({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...oe({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>ye(e).every(h=>h!=null&&typeof h=="object")},...ue({clearable:!0})},"VFileInput"),He=Ve()({name:"VFileInput",inheritAttrs:!1,props:Ne(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,h){let{attrs:q,emit:R,slots:s}=h;const{t:y}=he(),o=ke(e,"modelValue"),{isFocused:r,focus:P,blur:w}=ie(e),V=g(()=>typeof e.showSize!="boolean"?e.showSize:void 0),F=g(()=>(o.value??[]).reduce((t,u)=>{let{size:C=0}=u;return t+C},0)),k=g(()=>O(F.value,V.value)),c=g(()=>(o.value??[]).map(t=>{const{name:u="",size:C=0}=t;return e.showSize?`${u} (${O(C,V.value)})`:u})),i=g(()=>{var u;const t=((u=o.value)==null?void 0:u.length)??0;return e.showSize?y(e.counterSizeString,t,k.value):y(e.counterString,t)}),a=f(),p=f(),v=f(),Z=g(()=>r.value||e.active),U=g(()=>["plain","underlined"].includes(e.variant));function D(){var t;v.value!==document.activeElement&&((t=v.value)==null||t.focus()),r.value||P()}function G(t){$(t)}function H(t){R("mousedown:control",t)}function $(t){var u;(u=v.value)==null||u.click(),R("click:control",t)}function K(t){t.stopPropagation(),D(),_e(()=>{o.value=[],Ie(e["onClick:clear"],t)})}return Ce(o,t=>{(!Array.isArray(t)||!t.length)&&v.value&&(v.value.value="")}),Se(()=>{const t=!!(s.counter||e.counter),u=!!(t||s.details),[C,W]=be(q),{modelValue:Ee,...X}=M.filterProps(e),ee=re(e);return l(M,x({ref:a,modelValue:o.value,"onUpdate:modelValue":S=>o.value=S,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-input--plain-underlined":U.value},e.class],style:e.style,"onClick:prepend":G},C,X,{centerAffix:!U.value,focused:r.value}),{...s,default:S=>{let{id:A,isDisabled:b,isDirty:E,isReadonly:L,isValid:te}=S;return l(ce,x({ref:p,"prepend-icon":e.prependIcon,onMousedown:H,onClick:$,"onClick:clear":K,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},ee,{id:A.value,active:Z.value||E.value,dirty:E.value,disabled:b.value,focused:r.value,error:te.value===!1}),{...s,default:ae=>{var j;let{props:{class:le,...ne}}=ae;return l(N,null,[l("input",x({ref:v,type:"file",readonly:L.value,disabled:b.value,multiple:e.multiple,name:e.name,onClick:m=>{m.stopPropagation(),L.value&&m.preventDefault(),D()},onChange:m=>{if(!m.target)return;const se=m.target;o.value=[...se.files??[]]},onFocus:D,onBlur:w},ne,W),null),l("div",{class:le},[!!((j=o.value)!=null&&j.length)&&(s.selection?s.selection({fileNames:c.value,totalBytes:F.value,totalBytesReadable:k.value}):e.chips?c.value.map(m=>l(B,{key:m,size:"small",color:e.color},{default:()=>[m]})):c.value.join(", "))])])}})},details:u?S=>{var A,b;return l(N,null,[(A=s.details)==null?void 0:A.call(s,S),t&&l(N,null,[l("span",null,null),l(de,{active:!!((b=o.value)!=null&&b.length),value:i.value},s.counter)])])}:void 0})}),fe({},a,p,v)}}),Te={class:"d-flex justify-end"},Ue={key:1},$e={class:"d-flex justify-center align-center"},Ke=Re({__name:"ViewRequestedLicense",props:{listRequestedLicense:{type:Function}},setup(e){const q=Pe().permissions,R=e,s=f(1),y=f(10),o=f(100),r=f(!0),P=f([]),w=[{label:"Approved",value:"approved"},{label:"Declined",value:"declined"},{label:"Pending",value:"pending"}],V=f(w.map(c=>c.value)),F=[{title:"REQUESTER",key:"requester"},{title:"ISSUER",key:"issuer"},{title:"QUOTA",key:"quota"},{title:"ADMIN",key:"actor"},{title:"STATUS",key:"state",sortable:!1,align:"center"}];function k(){r.value=!0,R.listRequestedLicense({page:s.value,limit:y.value,states:V.value}).then(async c=>{const i=c.data.result;P.value=i.topupRequests||[],o.value=i.recordsCount}).finally(()=>{setTimeout(()=>{r.value=!1},2e3)})}return we(()=>{k()}),(c,i)=>(_(),z(ve,null,{default:n(()=>[l(me,null,{default:n(()=>[T("div",Te,[Q(q)["topup_request.create"]?(_(),z(Y,{key:0,color:"primary"},{default:n(()=>[d(" TopUp License "),Fe(c.$slots,"create",{loadRequestedLicense:k})]),_:3})):J("",!0)])]),_:3}),l(pe,null,{default:n(()=>[l(xe,{"return-object":"","show-select":"",color:"secondary",page:s.value,"onUpdate:page":i[1]||(i[1]=a=>s.value=a),"items-per-page":y.value,"onUpdate:itemsPerPage":i[2]||(i[2]=a=>y.value=a),headers:F,"items-length":o.value,items:P.value,loading:r.value,"item-value":"name"},{loading:n(()=>[d(" Loading requested license... ")]),"item.state":n(({item:a})=>[a.state=="approved"?(_(),z(B,{key:0,label:"",color:"success"},{default:n(()=>[d(" Accepted ")]),_:1})):a.state=="declined"?(_(),Ae("div",Ue,[l(B,{label:"",color:"error"},{default:n(()=>[d(" Declined ")]),_:1}),l(Y,{ripple:!1,icon:"",size:"small",variant:"text"},{default:n(()=>[l(De,null,{default:n(()=>[d(I(Q(ze)),1)]),_:1}),l(Be,{title:"Decline Notes",message:a.declinedReason},null,8,["message"])]),_:2},1024)])):a.state=="pending"?(_(),z(B,{key:2,label:"",color:"warning"},{default:n(()=>[d(" Pending ")]),_:1})):J("",!0)]),"item.issuer":n(({item:a})=>[d(I(a.issuer.name),1)]),"item.actor":n(({item:a})=>{var p;return[d(I(((p=a.actor)==null?void 0:p.name)||"-"),1)]}),"item.requester":n(({item:a})=>[d(I(a.requester.name),1)]),"header.state":n(({column:a})=>[T("span",$e,[T("div",null,I(a.title),1),l(qe,{disabled:r.value,items:w,modelValue:V.value,"onUpdate:modelValue":i[0]||(i[0]=p=>V.value=p)},null,8,["disabled","modelValue"])])]),_:2},1032,["page","items-per-page","items-length","items","loading"])]),_:1})]),_:3}))}});export{He as V,Ke as _};
