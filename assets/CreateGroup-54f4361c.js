import{_ as N}from"./IssuerInput.vue_vue_type_script_setup_true_lang-f322e8e1.js";import{r as g}from"./rules-3c02e6d9.js";import{V as B}from"./VTextField-d6d2aeeb.js";import{V as P}from"./VTextarea-0f79b0ed.js";import{V as j}from"./VForm-3ddb7e8c.js";import{d as S,z as I,r as i,R as D,o as U,h as y,g as t,f as a,m as b,w as G,u as E,a as c,j as v,S as F,c as R,i as T}from"./index-033028ba.js";import{g as L}from"./user-f49a07c4.js";import{_ as W,a as q}from"./SelectPermission.vue_vue_type_script_setup_true_lang-f4162f67.js";import{c as z}from"./group-63c87c69.js";import{u as H}from"./snackbar-82b4b4e3.js";import{w as O}from"./lazy-62b0a598.js";import{b as x,a as k,V as A}from"./VRow-cccfd752.js";import{V as f,p as J}from"./VBtn-4c1884a2.js";import{V as K,a as M,b as C,c as Q,d as w}from"./VStepper-5968c5ff.js";import{c as $}from"./index-fc6a3455.js";import"./issuer-6495046d.js";import"./api-f2d6da92.js";import"./VList-12c50827.js";import"./tag-13d67880.js";import"./VAutocomplete-dda41355.js";import"./filter-6f6c7ae3.js";import"./VChip-87521e80.js";import"./permission-4358f34e.js";const X=S({__name:"GroupInformation",props:{valid:{type:[Boolean,null]},modelValue:{}},emits:["update:valid","update:modelValue"],setup(_,{emit:V}){const o=_,m=V,u=I({get(){return o.valid},set(p){m("update:valid",p)}}),r=i(""),n=i(""),d=i();return D(()=>{m("update:modelValue",{name:r.value,description:n.value,issuer:d.value})}),(p,s)=>(U(),y(j,{"validate-on":"input",modelValue:u.value,"onUpdate:modelValue":s[3]||(s[3]=e=>u.value=e)},{default:t(()=>[a(B,{class:"mb-3",rules:b(g),modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),label:"Name"},null,8,["rules","modelValue"]),a(P,{class:"mb-3",rules:b(g),modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=e=>n.value=e),label:"Description"},null,8,["rules","modelValue"]),a(N,{rules:b(g),modelValue:d.value,"onUpdate:modelValue":s[2]||(s[2]=e=>d.value=e)},null,8,["rules","modelValue"])]),_:1},8,["modelValue"]))}}),Y=S({__name:"SelectUser",props:{modelValue:{},issuer:{}},emits:["update:modelValue"],setup(_,{emit:V}){const o=_,m=V,u=i(10),r=i(1),n=i([]),d=I({get(){return o.modelValue},set(s){m("update:modelValue",s)}});async function p({done:s}){L({limit:u.value,page:r.value,issuerId:o.issuer.id}).then(e=>{const l=e.data.result;l.users?(n.value.push(...l.users||[]),s("ok"),r.value++):s("empty")}).catch(()=>{})}return G(()=>o.issuer,()=>{d.value=[],n.value=[],r.value=1},{deep:!0}),(s,e)=>(U(),y(W,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l),onLoadUsers:p,users:n.value},null,8,["modelValue","users"]))}}),Z={class:"d-flex align-center"},h=c("div",{class:"text-h5 font-weight-bold"},"Create Groups",-1),ee={class:"d-flex justify-start"},ae={key:0,class:"ma-2"},le={class:"d-flex justify-start mt-4"},te={class:"d-flex justify-start mt-4"},Ie=S({__name:"CreateGroup",setup(_){const V=E(),o=i(1),m=i(!1),u=i({name:"",description:"",issuer:null}),r=i([]),n=i({}),d=H();function p(){var e;const s={name:u.value.name,description:u.value.description,issuerId:(e=u.value.issuer)==null?void 0:e.id,userIds:r.value.map(l=>l.id),permissions:n.value};z(s).then(l=>{if(!l.data.success)throw Error;d.showSnackbar("User group created","success"),V.push({name:"group.see"})}).catch(()=>{d.showSnackbar("Create user group failed","error")})}return(s,e)=>(U(),y(A,{fluid:""},{default:t(()=>[a(k,null,{default:t(()=>[a(x,null,{default:t(()=>[c("div",Z,[a(f,{icon:"",variant:"text",to:{name:"group.see"},exact:""},{default:t(()=>[a(J,null,{default:t(()=>[v(F(b(O)),1)]),_:1})]),_:1},8,["to"]),h])]),_:1})]),_:1}),a(k,null,{default:t(()=>[a(x,null,{default:t(()=>[a(K,{elevation:"0",modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value=l)},{default:t(()=>[a(M,null,{default:t(()=>[a(C,{title:"Information",value:1}),a($),a(C,{title:"Select User",value:2}),a($),a(C,{title:"Select Permission",value:3})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(k,{class:"align-start"},{default:t(()=>[a(x,null,{default:t(()=>[a(Q,{modelValue:o.value,"onUpdate:modelValue":e[9]||(e[9]=l=>o.value=l)},{default:t(()=>[a(w,{value:1},{default:t(()=>[a(X,{class:"ma-2",modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=l=>u.value=l),valid:m.value,"onUpdate:valid":e[2]||(e[2]=l=>m.value=l)},null,8,["modelValue","valid"]),c("div",ee,[a(f,{disabled:!m.value,variant:"tonal",onClick:e[3]||(e[3]=l=>o.value++)},{default:t(()=>[v(" Next ")]),_:1},8,["disabled"])])]),_:1}),a(w,{value:2},{default:t(()=>[u.value.issuer?(U(),R("div",ae,[a(Y,{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value=l),issuer:u.value.issuer},null,8,["modelValue","issuer"])])):T("",!0),c("div",le,[a(f,{class:"me-2",variant:"tonal",onClick:e[5]||(e[5]=l=>o.value--)},{default:t(()=>[v(" Previous ")]),_:1}),a(f,{disabled:r.value.length<=0,variant:"tonal",onClick:e[6]||(e[6]=l=>o.value++)},{default:t(()=>[v(" Next ")]),_:1},8,["disabled"])])]),_:1}),a(w,{value:3},{default:t(()=>[a(q,{modelValue:n.value,"onUpdate:modelValue":e[7]||(e[7]=l=>n.value=l)},null,8,["modelValue"]),c("div",te,[a(f,{class:"me-2",variant:"tonal",onClick:e[8]||(e[8]=l=>o.value--)},{default:t(()=>[v(" Previous ")]),_:1}),a(f,{disabled:Object.keys(n.value).length<=0,onClick:p,color:"primary"},{default:t(()=>[v(" Submit ")]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}});export{Ie as default};
