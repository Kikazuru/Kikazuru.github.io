import{q as M,r as R}from"./lazy-62b0a598.js";import{_ as P}from"./MessageDialog.vue_vue_type_script_setup_true_lang-0ac75953.js";import{d as D,r as c,w as S,o as u,h as d,g as e,f as t,j as l,a as U,m as k,c as N,S as _,a7 as Y}from"./index-033028ba.js";import{b as h,a as V,d as v,V as b,i as C}from"./index-fc6a3455.js";import{V as E,p as $}from"./VBtn-4c1884a2.js";import{V as B}from"./VDataTableServer-209fc9bb.js";import{V as w}from"./VChip-87521e80.js";import{a as A}from"./api-f2d6da92.js";import{_ as F}from"./IssuerInput.vue_vue_type_script_setup_true_lang-f322e8e1.js";import{b as p,a as x,V as H}from"./VRow-cccfd752.js";import{V as T}from"./VSkeletonLoader-b98b90e6.js";import"./tag-13d67880.js";import"./VList-12c50827.js";import"./filter-6f6c7ae3.js";import"./VTextField-d6d2aeeb.js";import"./issuer-6495046d.js";import"./VAutocomplete-dda41355.js";const O={class:"d-flex"},j={key:1},q=D({__name:"LockedLicenseTable",props:{getLockedLogs:{type:Function},issuer:{}},setup(f){const o=c(1),s=c(10),L=c(100),n=c(!0),y=[{title:"IDENTIFIER",key:"lockIdentifier"},{title:"STATUS",key:"success"},{title:"CREATED AT",key:"createdAt"}],r=f,g=c([]);function I(){n.value=!0;const m={limit:s.value,page:o.value};r.issuer&&(m.issuerId=r.issuer.id),r.getLockedLogs(m).then(i=>{const a=i.data.result;g.value=a.logs||[],L.value=a.recordsCount}).finally(()=>{setTimeout(()=>{n.value=!1},2e3)})}return S(()=>r.issuer,m=>{m&&I()},{deep:!0}),(m,i)=>(u(),d(b,null,{default:e(()=>[t(V,null,{default:e(()=>[t(h,null,{default:e(()=>[l("Locked License Log ")]),_:1})]),_:1}),t(v,{class:"mt-2"},{default:e(()=>[U("div",O,[t(E,{variant:"outlined","prepend-icon":k(M)},{default:e(()=>[l(" EXPORT ")]),_:1},8,["prepend-icon"])])]),_:1}),t(v,null,{default:e(()=>[t(B,{"return-object":"",color:"secondary",page:o.value,"onUpdate:page":i[0]||(i[0]=a=>o.value=a),"items-per-page":s.value,"onUpdate:itemsPerPage":i[1]||(i[1]=a=>s.value=a),headers:y,"items-length":L.value,items:g.value,loading:n.value,"item-value":"name"},{loading:e(()=>[l(" Loading locked license log... ")]),"item.success":e(({item:a})=>[a.success==!0?(u(),d(w,{key:0,label:"",color:"success"},{default:e(()=>[l(" Success ")]),_:1})):(u(),N("div",j,[t(w,{class:"me-2",label:"",color:"error"},{default:e(()=>[l(" Error ")]),_:1}),t(E,{icon:"",size:"small",variant:"text"},{default:e(()=>[t($,null,{default:e(()=>[l(_(k(R)),1)]),_:1}),t(P,{title:"Error Message",message:a.errorMessage},null,8,["message"])]),_:2},1024)]))]),"item.createdAt":e(({item:a})=>[l(_(k(Y)(a.createdAt,"DD MMM YYYY HH:mm")),1)]),_:2},1032,["page","items-per-page","items-length","items","loading"])]),_:1})]),_:1}))}}),z={class:"d-flex"},X={key:1},G=D({__name:"UsedLicenseTable",props:{getUsedLogs:{type:Function},issuer:{}},setup(f){const o=c(1),s=c(10),L=c(100),n=c(!0),y=[{title:"IDENTIFIER",key:"lockIdentifier"},{title:"STATUS",key:"success"},{title:"CREATED AT",key:"createdAt"},{title:"CARD NUMBER",key:"cardNumber"}],r=f,g=c([]);function I(){n.value=!0;const m={limit:s.value,page:o.value};r.issuer&&(m.issuerId=r.issuer.id),r.getUsedLogs(m).then(i=>{const a=i.data.result;g.value=a.logs||[],L.value=a.recordsCount}).finally(()=>{setTimeout(()=>{n.value=!1},2e3)})}return S(()=>r.issuer,m=>{m&&I()},{deep:!0}),(m,i)=>(u(),d(b,null,{default:e(()=>[t(V,null,{default:e(()=>[t(h,null,{default:e(()=>[l("Used License Log ")]),_:1})]),_:1}),t(v,{class:"mt-2"},{default:e(()=>[U("div",z,[t(E,{variant:"outlined","prepend-icon":k(M)},{default:e(()=>[l(" EXPORT ")]),_:1},8,["prepend-icon"])])]),_:1}),t(v,null,{default:e(()=>[t(B,{"return-object":"",color:"secondary",page:o.value,"onUpdate:page":i[0]||(i[0]=a=>o.value=a),"items-per-page":s.value,"onUpdate:itemsPerPage":i[1]||(i[1]=a=>s.value=a),headers:y,"items-length":L.value,items:g.value,loading:n.value,"item-value":"name"},{loading:e(()=>[l(" Loading used license log... ")]),"item.success":e(({item:a})=>[a.success==!0?(u(),d(w,{key:0,label:"",color:"success"},{default:e(()=>[l(" Success ")]),_:1})):(u(),N("div",X,[t(w,{class:"me-2",label:"",color:"error"},{default:e(()=>[l(" Error ")]),_:1}),t(E,{icon:"",size:"small",variant:"text"},{default:e(()=>[t($,null,{default:e(()=>[l(_(k(R)),1)]),_:1}),t(P,{title:"Error Message",message:a.errorMessage},null,8,["message"])]),_:2},1024)]))]),"item.createdAt":e(({item:a})=>[l(_(k(Y)(a.createdAt,"DD MMM YYYY HH:mm")),1)]),_:2},1032,["page","items-per-page","items-length","items","loading"])]),_:1})]),_:1}))}});async function J({limit:f=10,page:o=1,issuerId:s}){return await A.get("/licenses/lock",{params:{limit:f,page:o,issuerId:s}})}async function K({limit:f=10,page:o=1,issuerId:s}){return await A.get("/licenses/consume",{params:{limit:f,page:o,issuerId:s}})}async function Q({issuerId:f}){return await A.get("/licenses",{params:{issuerId:f}})}const W=U("div",{class:"text-h5 font-weight-bold"},"Owned License",-1),_e=D({__name:"OwnedLicense",setup(f){const o=c({reservedCount:0,availableCount:0,lockedCount:0,consumedCount:0}),s=c(!0);function L(){var y;s.value=!0,Q({issuerId:(y=n.value)==null?void 0:y.id}).then(r=>{const g=r.data.result;o.value=g}).finally(()=>{setTimeout(()=>{s.value=!1},2e3)})}const n=c();return S(n,()=>{L()}),(y,r)=>(u(),d(H,{fluid:""},{default:e(()=>[t(x,null,{default:e(()=>[t(p,null,{default:e(()=>[W]),_:1})]),_:1}),t(x,null,{default:e(()=>[t(p,null,{default:e(()=>[t(F,{density:"compact","auto-select-first":!0,modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=g=>n.value=g),class:"w-25 flex-grow-0 me-2"},null,8,["modelValue"])]),_:1})]),_:1}),t(x,null,{default:e(()=>[t(p,null,{default:e(()=>[t(b,null,{default:e(()=>[t(V,null,{default:e(()=>[t(h,null,{default:e(()=>[l(" Reserved License ")]),_:1}),t(C,null,{default:e(()=>[l("description")]),_:1})]),_:1}),s.value?(u(),d(T,{key:0,class:"mt-0",type:"heading"})):(u(),d(v,{key:1,class:"text-h4 font-weight-bold"},{default:e(()=>[l(_(o.value.reservedCount.toLocaleString("id")),1)]),_:1}))]),_:1})]),_:1}),t(p,null,{default:e(()=>[t(b,null,{default:e(()=>[t(V,null,{default:e(()=>[t(h,null,{default:e(()=>[l(" Remaining License ")]),_:1}),t(C,null,{default:e(()=>[l("description")]),_:1})]),_:1}),s.value?(u(),d(T,{key:0,class:"mt-0",type:"heading"})):(u(),d(v,{key:1,class:"text-h4 font-weight-bold"},{default:e(()=>[l(_(o.value.availableCount.toLocaleString("id")),1)]),_:1}))]),_:1})]),_:1}),t(p,null,{default:e(()=>[t(b,null,{default:e(()=>[t(V,null,{default:e(()=>[t(h,null,{default:e(()=>[l(" Locked License ")]),_:1}),t(C,null,{default:e(()=>[l("description")]),_:1})]),_:1}),s.value?(u(),d(T,{key:0,class:"mt-0",type:"heading"})):(u(),d(v,{key:1,class:"text-h4 font-weight-bold"},{default:e(()=>[l(_(o.value.lockedCount.toLocaleString("id")),1)]),_:1}))]),_:1})]),_:1}),t(p,null,{default:e(()=>[t(b,null,{default:e(()=>[t(V,null,{default:e(()=>[t(h,null,{default:e(()=>[l(" Used License ")]),_:1}),t(C,null,{default:e(()=>[l("description")]),_:1})]),_:1}),s.value?(u(),d(T,{key:0,class:"mt-0",type:"heading"})):(u(),d(v,{key:1,class:"text-h4 font-weight-bold"},{default:e(()=>[l(_(o.value.consumedCount.toLocaleString("id")),1)]),_:1}))]),_:1})]),_:1})]),_:1}),t(x,null,{default:e(()=>[t(p,{cols:"12",xxl:"6"},{default:e(()=>[t(q,{issuer:n.value,"get-locked-logs":k(J)},null,8,["issuer","get-locked-logs"])]),_:1}),t(p,{cols:"12",xxl:"6"},{default:e(()=>[t(G,{issuer:n.value,"get-used-logs":k(K)},null,8,["issuer","get-used-logs"])]),_:1})]),_:1})]),_:1}))}});export{_e as default};
